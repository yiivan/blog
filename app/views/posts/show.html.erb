<h1><%= @post.title %></h1>
<h3>Category: <%= @post.category.title %></h3>
<p><%= @post.body %></p>
<p>Tags: <%= @post.tags.map{|t| t.name }.join(", ") %></p>
<% if can? :update, @post %>
  <%= link_to "Edit", edit_post_path(@post) %>
<% end %>
<% if can? :destroy, @post %>
  <%= link_to "Delete", post_path(@post),
                        method: :delete,
                        data: {confirm: "Are you sure you want to delete this post?"}%>
<% end %>

<% if user_favorite %>
  <%= link_to "Un-favorite", post_favorite_path(@post, user_favorite), method: :delete %>
<% else %>
  <%= link_to "Favorite", post_favorites_path(@post), method: :post %>
<% end %>

(<%= @post.favorites.count %>)


<hr>
<h3>Comments:</h3>
<div id="comment-form">
  <%= form_for [@post, @comment] do |f| %>
    <div>
      <%= f.text_area :body %>
    </div>
    <%= f.submit data: {disable_with: "submitting..."} %>
  <% end %>
  <br>
  <%= @comment.errors.full_messages.join(", ") %>
</div>


<h2>Reviews:</h2>
<div id="comments">
  <% @post.comments.order(created_at: :desc ).each do |comm| %>
    <div>
      By: <%= comm.user.full_name.titleize %>
      <br>
      <%= comm.body %>
      <br>
      <% if can? :destroy, comm %>
        <%= link_to "delete", post_comment_path(@post, comm),
                              method: :delete,
                              data: {confirm: "Are you sure?"} %>
      <% end %>
      <br>
      <br>
    </div>
  <% end %>
</div>
